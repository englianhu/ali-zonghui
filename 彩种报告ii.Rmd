---
title: "<span style='color:Red'>é˜¿é‡Œå½©ç¥¨</span>"
subtitle: "å½©ç§æŠ¥å‘Š (Part II)"
author: "é›·æ¬§ <img src='figure/foxi_daoshi.jpg' width='24'>"
date: "`r lubridate::today('Asia/Tokyo')`"
output:
  html_document: 
    mathjax: https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js
    number_sections: yes
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: yes
      smooth_scroll: yes
    code_folding: hide
    css: CSSBackgrounds.css
---

<br>

# ç®€ä»‹

<br>

```{r message=FALSE, warning=FALSE, results='asis'}
## 3210448065@qq.com
## leiou123

## 2849108450@qq.com
## leiou123
## https://rstudio.cloud/project/1198888
if(!require('BBmisc')) {install.packages('BBmisc', dependencies = TRUE, 
                                         INSTALL_opts = '--no-lock')}
require('BBmisc')
pkg <- c('plyr', 'tidyverse', 'magrittr', 'readr', 'readxl', 'tidyr', 'MASS', 
         'knitr', 'kableExtra', 'forecast', 'formattable', 'DT', 'echarts4r', 
         'lubridate', 'highcharter', 'htmltools', 'readr', 'pryr', 'sparklyr', 
         'lme4', 'microbenchmark', 'polynom', 'multipol', 'splines', 'leaps', 
         'highr', 'dplyr', 'pacman')

#plyr::l_ply(pkg, require, quietly = TRUE, character.only = TRUE, .print = FALSE)
suppressAll(lib(pkg))
rm(pkg)
#sc <- spark_connect(master = 'local')
```

å½“åˆåœ¨æ¨å¹¿éƒ¨é—¨ï¼Œ**å®‹ç¥–ï¼šå®‹ç»„é•¿**ç»™ä¸ªæ ·æœ¬æ•°æ®ï¼Œæˆ‘å°±å°è¯•ä½¿ç”¨çº¿æ€§æ¨¡å‹å’Œæ—¶é—´åºåˆ—`arima`æ¨¡å‹åˆ†æäº†è¿›ç²‰ä¸šç»©ï¼Œè¯¦æƒ…è¯·å‚è€ƒ[é˜¿é‡Œå½©ç¥¨ - åˆ†ææ ·æœ¬æ•°æ®](https://rpubs.com/englianhu/ali)^[åŸºäºæ•°æ®è§‚æµ‹å€¼å¤ªå°‘^[[binary.com Interview Question I (Extention)](https://rpubs.com/englianhu/binary-Q1E)å°è¯•åˆ†åˆ«ä½¿ç”¨`3ä¸ªæœˆ`ã€`6ä¸ªæœˆ`ã€`12ä¸ªæœˆ`ã€`18ä¸ªæœˆ`å’Œ`24ä¸ªæœˆ`çš„æ•°æ®ï¼Œç»“æœ`12ä¸ªæœˆ`çš„æ•°æ®æœ€ä¸ºç²¾å‡†ã€‚]ï¼Œæ‰€ä»¥æš‚æ—¶æ²¡æœ‰é¢„æµ‹ã€‚]ã€‚ç„¶åè½¬åˆ°è¿ç»´éƒ¨é—¨åˆ†æäº†[é˜¿é‡Œå½©ç¥¨ - å½©ç§æŠ¥å‘Š](https://rpubs.com/englianhu/ali_bet_type)ï¼Œåªæ˜¯åŸºæœ¬åˆ†æå½©ç§ï¼Œå°†æ•°æ®è§†è§‰åŒ–ï¼›æ­¤å•†ä¸šåˆ†æè¿›ä¸€æ­¥ä½¿ç”¨æ··åˆçº¿æ€§æ¨¡å‹åˆ†ææ•°æ®ï¼Œé¢„æµ‹å½©ç§ç›ˆåˆ©ã€‚

<br>
<br>

# æ•°æ®

<br>

è¯»å–æ ·æœ¬æ•°æ®ã€‚

```{r, results = 'asis', warning = FALSE}
## è¯»å–æ•°æ®
fls <- suppressWarnings(list.files('data/å½©ç§'))
smp <- fls %>% llply(., function(x) {
    dtt <- x %>% str_replace_all('.xls', '') %>% ymd
    smpp <- read_excel(paste0('data/å½©ç§/', x)) %>% 
      .[-nrow(.),]
    data.frame('æ—¥æœŸ' = dtt, smpp)
}) %>% bind_rows %>% 
    as_tibble %>% 
    mutate('å½©ç§åç§°' = factor(å½©ç§åç§°), 'ç›ˆç‡' = as.numeric(percent(ç›ˆç‡))) %>% 
    mutate_if(is.character, as.numeric)
rm(fls)

nm <- names(smp)
names(smp) <- c('Date', 'Type', 'Bettor', 'Turnover', 'Won', 'Cancelled', 'Rebates', 'Profit', 'Profit_rate')

## è½¬åŒ–ä¸ºå¤§æ•°æ®
smp2 <- smp
#smp2 <- copy_to(sc, smp2)

# smp2 %>% 
#   as_tibble %>% 
#   kbl('html', caption = 'æ¯æ—¥æŠ•æ³¨äººæ•°', escape = F) %>% 
#   kable_styling(
#     bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
#   scroll_box(height = '400px')
```

```{r}
smp2 %>% glimpse
```

<span style='color:Orange'>*å›¾è¡¨2.1ï¼šæ•°æ®ç®€ä»‹*</span>

<s>ä¸Šå›¾</s>[é˜¿é‡Œå½©ç¥¨ - å½©ç§æŠ¥å‘Š](https://rpubs.com/englianhu/ali_bet_type)æ˜¾ç¤ºä»`r smp$Date %>% range %>% .[1]`åˆ°`r smp$Date %>% range %>% .[2]`çš„æŠ¥è¡¨æ•°æ®ï¼Œä¸€å…±æœ‰`r nrow(smp2)`ä¸ªè§‚æµ‹å€¼ã€‚

<br>
<br>

# ç»Ÿè®¡æ¨¡å‹

<br>

## å¤šå…ƒç›¸äº’å¼æ¨¡å‹

<br>

ä»¥ä¸‹æ•°æ®æ˜¾ç¤ºæ¯æ—¥æŠ•æ³¨äººæ•°ã€‚

```{r, results = 'asis', warning = FALSE}
# smp2 %>%
#     spark_apply(
#         function(e) summary(lm(Profit ~ Turnover * Bettor * Won, e))$r.squared,
#         names = 'r.squared',
#         group_by = 'Type')

# æ¯æ—¥è§‚æµ‹å€¼
smp2 %>% 
    ddply(.(Date), nrow) %>% 
    as_tibble %>% dplyr::rename(n = V1) %>% 
  ## https://www.colorhexa.com/color-names
  mutate(n = color_tile('#007fff', 'white')(n)) %>% #azure
  kbl('html', caption = 'æ¯æ—¥æŠ•æ³¨äººæ•°', escape = F, align = 'c') %>% 
  kable_styling(
    bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  scroll_box(height = '400px')
```

<span style='color:Orange'>*å›¾è¡¨3.1.1ï¼šæ¯æ—¥è§‚æµ‹å€¼*</span>

<br>

æˆ‘ä¸æ™“å¾—æœ€ä¼˜æ¨¡å‹ï¼Œå…ˆä»¥å®Œæ•´æ•°æ®è§‚æµ‹å€¼ä¸ºæ ‡å‡†ï¼Œä»¥ä¸‹ä¹ƒ`å¤šå…ƒç›¸äº’å¼æ¨¡å‹`^[[å¦‚ä½• Estimate linear models](https://d.cosx.org/d/419820-estimate-linear-models/7)ä¸­çš„[UNDERSTANDING 3-WAY INTERACTIONS BETWEEN CONTINUOUS VARIABLES](https://tomhouslay.com/2014/03/21/understanding-3-way-interactions-between-continuous-variables/#comment-63365)]ã€‚

$$
\begin{align*}
 Y& = \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}X_{1}X_{2}\\ 
 &= \beta_{0} + \widetilde{\beta_{1}}X_{1} + \beta_{2}X_{2};  \widetilde{\beta_{1}} = \beta_{1} + \beta_{2}X_{2}\\
\end{align*}
$$

$$
\begin{align*}
 Y& = \beta_{0} + \beta_{1}X_{1} + \beta_{2}X_{2} + \beta_{3}X_{1}X_{2}\\ 
 &= \beta_{0} + \color{Red}\widetilde{\beta_{1}}X_{1} + \beta_{2}X_{2}; \color{Red}\widetilde{\beta_{1}} = \beta_{1} + \beta_{2}X_{2}\\
\end{align*}
$$
<span style='color:Orange'>*æ–¹ç¨‹3.1.1ï¼šå¤šå…ƒç›¸äº’å¼æ¨¡å‹ï¼ˆ[åœ¨çº¿LaTEXæ–¹ç¨‹ç¼–è¾‘å™¨](https://www.codecogs.com/latex/eqneditor.php)ï¼‰*</span>

$$
\begin{align*}
\color{red}{x} + \color{blue}{y}\\

{\color{red} x} + {\color{blue} y}\\

\color{Red} \beta_{1}X_{1}\\

{\color{Red} \beta_{1}}X_{1}\\
\end{align*}
$$
$$
\begin{align*}
\color{Red} \widetilde{\beta_{1}}X_{1}\\

{\color{Red} \widetilde{\beta_{1}}}X_{1}\\
\end{align*}
$$

```{r, results = 'asis', eval = FALSE, warning = FALSE}
# lm1 <- lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2)

# m.aic.backward1 <- step(lm1, direction = 'backward', trace = 1)
# m.aic.backward2 <- step(lm1)

md <- list(
  m00 = lm(Profit ~ Date * Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m01 = lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m02 = lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled, smp2) %>% extractAIC, 
  m03 = lm(Profit ~ Type * Bettor * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m04 = lm(Profit ~ Type * Bettor * Turnover * Cancelled * Rebates, smp2) %>% extractAIC, 
  m05 = lm(Profit ~ Type * Bettor * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m06 = lm(Profit ~ Type * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m07 = lm(Profit ~ Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m08 = lm(Profit ~ Type * Bettor * Turnover * Won, smp2) %>% extractAIC, 
  m09 = lm(Profit ~ Type * Bettor * Turnover * Rebates, smp2) %>% extractAIC, 
  m10 = lm(Profit ~ Type * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m11 = lm(Profit ~ Type * Bettor * Turnover * Cancelled, smp2) %>% extractAIC, 
  m12 = lm(Profit ~ Type * Bettor * Won * Rebates, smp2) %>% extractAIC, 
  m13 = lm(Profit ~ Type * Bettor * Won * Cancelled, smp2) %>% extractAIC, 
  m14 = lm(Profit ~ Type * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m15 = lm(Profit ~ Type * Turnover * Cancelled * Rebates, smp2) %>% extractAIC, 
  m16 = lm(Profit ~ Type * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m17 = lm(Profit ~ Type * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m18 = lm(Profit ~ Bettor * Turnover * Won * Cancelled, smp2) %>% extractAIC, 
  m19 = lm(Profit ~ Bettor * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m20 = lm(Profit ~ Bettor * Turnover * Cancelled * Rebates, smp2) %>% extractAIC, 
  m21 = lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m22 = lm(Profit ~ Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC) %>% 
  ldply %>% 
  as_tibble %>% 
  dplyr::rename(df = V1, AIC = V2)

## save files, easier to read.
microbenchmark(
   save(md, file = 'data/md.rda'), 
   write_rds(md, path = 'data/md.rds'), 
   saveRDS(md, file = 'data/md.rds'))
#Unit: microseconds
#                                expr     min       lq     mean   median      uq     max neval
#      save(md, file = "data/md.rda") 114.666 130.9080 135.2061 134.3990 137.111 174.759   100
# write_rds(md, path = "data/md.rds") 111.098 120.6370 126.8601 125.1935 129.534 178.582   100
#   saveRDS(md, file = "data/md.rds") 143.649 160.3135 178.6935 183.2730 186.673 358.803   100
```

1) $m00 = lm(Profit \sim Date * Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2)$
2) $m01 = lm(Profit \sim Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2)$
3) $m02 = lm(Profit \sim Type * Bettor * Turnover * Won * Cancelled, smp2)$
4) $m03 = lm(Profit \sim Type * Bettor * Turnover * Won * Rebates, smp2)$
5) $m04 = lm(Profit \sim Type * Bettor * Turnover * Cancelled * Rebates, smp2)$
6) $m05 = lm(Profit \sim Type * Bettor * Won * Cancelled * Rebates, smp2)$
7) $m06 = lm(Profit \sim Type * Turnover * Won * Cancelled * Rebates, smp2)$
8) $m07 = lm(Profit \sim Bettor * Turnover * Won * Cancelled * Rebates, smp2)$
9) $m08 = lm(Profit \sim Type * Bettor * Turnover * Won, smp2)$
10) $m09 = lm(Profit \sim Type * Bettor * Turnover * Rebates, smp2)$
11) $m10 = lm(Profit \sim Type * Won * Cancelled * Rebates, smp2)$
12) $m11 = lm(Profit \sim Type * Bettor * Turnover * Cancelled, smp2)$
13) $m12 = lm(Profit \sim Type * Bettor * Won * Rebates, smp2)$
14) $m13 = lm(Profit \sim Type * Bettor * Won * Cancelled, smp2)$
15) $m14 = lm(Profit \sim Type * Turnover * Won * Rebates, smp2)$
16) $m15 = lm(Profit \sim Type * Turnover * Cancelled * Rebates, smp2)$
17) $m16 = lm(Profit \sim Type * Turnover * Won * Rebates, smp2)$
18) $m17 = lm(Profit \sim Type * Won * Cancelled * Rebates, smp2)$
19) $m18 = lm(Profit \sim Bettor * Turnover * Won * Cancelled, smp2)$
20) $m19 = lm(Profit \sim Bettor * Turnover * Won * Rebates, smp2)$
21) $m20 = lm(Profit \sim Bettor * Turnover * Cancelled * Rebates, smp2)$
22) $m21 = lm(Profit \sim Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2)$
23) $m22 = lm(Profit \sim Turnover * Won * Cancelled * Rebates, smp2)$

<span style='color:Orange'>*æ–¹ç¨‹3.1ï¼šçº¿å‹æ¨¡å‹*</span>

ä»¥ä¸Šæ¨¡å‹ä½¿ç”¨$lm()$å‡½æ•°ï¼Œä»æ¨¡å‹$m00 \sim m22$ï¼Œ[How to Make Beautiful Tables in R](https://rfortherestofus.com/2019/11/how-to-make-beautiful-tables-in-r/)æœ‰å¾ˆå¤šæ¡Œè¡¨ç¨‹åºåŒ…ï¼Œä»¥ä¸‹å’±ä»¬æ¯”è¾ƒä¸‹**æœ€ä¼˜æ¨¡å‹**ã€‚

<br>

### formattable

<br>

```{r, results = 'asis', warning = FALSE}
md <- read_rds('data/md.rds')
md2 <- md

## https://www.colorhexa.com/color-names
md2 %>% 
  formattable(
    list(
        AIC = formatter('span', style = x ~ formattable::style(
            color = ifelse(rank(x) <= 3, 'darkgoldenrod', 'grey')), 
            x ~ paste0(round(x, 2), 
                       ' (rank: ', sprintf('%1.f', rank(x)), ')')))) %>% 
    mutate(df = color_tile('#2a52be', 'white')(df)) #colbalt
```

<span style='color:Orange'>*æ–¹ç¨‹3.1.1ï¼šæœ€ä¼˜æ¨¡å‹AICæ¯”è¾ƒ*</span>

<br>

### kableExtra

<br>

```{r, results = 'asis', warning = FALSE}
## https://www.colorhexa.com/color-names
md2 %>% 
  mutate(
    df = color_tile('#2a52be', 'white')(df), #colbalt
    AIC = ifelse(
      rank(AIC) <= 3, 
      cell_spec(
        paste0(round(AIC, 2), ' (rank: ', sprintf('%1.f', rank(AIC)), ')'), 
        'html', color = 'darkgoldenrod', bold = T), 
      cell_spec(
        paste0(round(AIC, 2), ' (rank: ', sprintf('%1.f', rank(AIC)), ')'), 
        'html', color = 'grey', italic = T))) %>% 
  kbl('html', caption = 'æœ€ä¼˜æ¨¡å‹', escape = F, align = c('c', 'r', 'r')) %>% 
  kable_styling(
    bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material() %>% 
  scroll_box(height = '400px')
```

<span style='color:Orange'>*æ–¹ç¨‹3.1.2ï¼šæœ€ä¼˜æ¨¡å‹AICæ¯”è¾ƒ*</span>

<br>

ä»¥ä¸‹æ¨¡å‹ä¹ƒå‰ä¸‰æ¦œï¼Œåˆ†åˆ«æ˜¯$m00$æ‰€æœ‰å› ç´ ï¼ŒåŒ…æ‹¬æ—¶é—´åºåˆ—å‚æ•°å› ç´ ï¼›$m07$å¿½ç•¥å½©ç§å› ç´ ï¼›$m22$åªåŒ…æ‹¬`æŠ•æ³¨é‡‘é¢`ã€`ä¸­å¥–é‡‘é¢`ã€`æ’¤å•é‡‘é¢`å’Œ`è¿”ç‚¹é‡‘é¢`å› ç´ ã€‚

1) $m00 = lm(Profit \sim Date * Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2)$
8) $m07 = lm(Profit \sim Bettor * Turnover * Won * Cancelled * Rebates, smp2)$
23) $m22 = lm(Profit \sim Turnover * Won * Cancelled * Rebates, smp2)$

<span style='color:Orange'>*æ–¹ç¨‹3.1.2.1ï¼šçº¿å‹æ¨¡å‹*</span>

<span style='color:Red'>**å¤‡æ³¨**ï¼šä»¥ä¸Šæœ€ä¼˜æ¨¡å‹åŠ å…¥æ—¶é—´å˜é‡ï¼Œä¸è¿‡ä¹‹åç« èŠ‚çš„æ—¶é—´åºåˆ—æ¨¡å‹ï¼Œä¹Ÿå¾—ä¸ªåˆ«åˆ†æ**$m00$**å’Œ**$m07$**ï¼Œå› ä¸ºå·²ç»æŠŠæ—¶é—´å˜é‡åŠ å…¥åˆ†æï¼Œå†åŠ ä¸Šæ—¶é—´åºåˆ—çš„è¯ï¼Œä¸æ™“å¾—æ˜¯å¦å˜è´¨å‘¢ï¼Ÿ</span>

<br>
<br>

## å¤šé¡¹å¼æ¨¡å‹

<br>

### æ­£äº¤ä¸åŸå§‹å¤šé¡¹å¼æ¨¡å‹

<br>

#### å¤šé¡¹å¼åŸºæœ¬æ¨¡å‹

<br>

- [å…³äºrï¼šæ‹Ÿåˆç”±`leaps :: regsubsets`é€‰æ‹©çš„å¤šé¡¹å¼å›å½’æ¨¡å‹](https://www.codenong.com/51223897)æœ‰ä¸¾ä¾‹ï¼Œè¿˜ä»‹ç»äº†`leaps`ç¨‹åºåŒ…ã€‚
- [lm()ä¸­çš„poly(): rawå’Œæ­£äº¤ä¹‹é–“çš„å·®ç•°](https://www.itdaan.com/tw/c0fe14f3fda89205497a506bf9e9c119)
- [Rå®ç°Polynomial regression](https://www.jianshu.com/p/8e6cc12d3036)
- [å¤šé¡¹å¼å›å½’ï¼ˆPolynomial regressionï¼‰åŠçº¿æ€§æ£€éªŒ](https://www.bioinfo-scrounger.com/archives/polynomial-regression)
- [How to interpret coefficients from a polynomial model fit?](https://stats.stackexchange.com/a/95952/68357)
- [poly() in lm(): difference between raw vs. orthogonal](https://stackoverflow.com/a/30000214/3806250)
- [Fitting Polynomial Regression in R](https://www.r-bloggers.com/2015/09/fitting-polynomial-regression-in-r)^[Section**How to fit a polynomial regression** in [Fitting Polynomial Regression in R](https://www.r-bloggers.com/2015/09/fitting-polynomial-regression-in-r) ]
- [Raw or orthogonal polynomial regression?](https://stats.stackexchange.com/questions/258307/raw-or-orthogonal-polynomial-regression)
- [Multivariate polynomials in R (`polynom` package)](https://cran.r-project.org/web/packages/multipol/vignettes/multipol.pdf)^[[Multivariate polynomials in R (`polynom` package)](https://cran.r-project.org/web/packages/multipol/vignettes/multipol.pdf)å¯ä¾›Rä½¿ç”¨è€…ä½¿ç”¨å¤šå…ƒéçº¿æ€§æ¨¡å‹]
- [Multivariate Polynomial Regression in R (Prediction)](https://stackoverflow.com/a/50261058/3806250)

![<span style='color:Orange'>*å›¾åƒ3.2.1ï¼šå¤šé¡¹å¼çº¿å‹æ¨¡å‹*</span>* [Fitting Polynomial Regression in R](https://www.r-bloggers.com/2015/09/fitting-polynomial-regression-in-r)*](figure/How to fit a polynomial regression 2.png)

<span style='color:Red'>**å¤‡æ³¨**ï¼š[lm() breaks when using poly() with predictors set up as factors](https://stackoverflow.com/a/61410867/3806250)è®²è¿°`poly`æ— æ³•åˆ†æå¤šå…ƒ`factor`è€Œåªèƒ½åˆ†æè™šæ‹Ÿå˜é‡ï¼ˆ0æˆ–1ï¼‰ã€‚</span>

<br>

##### æ­£äº¤æ¨¡å‹

<br>

```{r, results = 'asis', eval = FALSE, warning = FALSE}
## https://stackoverflow.com/a/24133767/3806250
num <- 5#2:5

mprf_list <- llply(num, function(i) {
  mprf = list(
    #p00 = lm(Profit ~ 
    #         poly(Date, degree = i) * 
    #         poly(Bettor, degree = i) * 
    #         poly(Turnover, degree = i) * 
    #         poly(Won, degree = i) * 
    #         poly(Cancelled, degree = i) * 
    #         poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p01 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p02 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i), smp2) %>% extractAIC, 
    p03 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p04 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p05 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p06 = lm(Profit ~ 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p07 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p08 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i), smp2) %>% extractAIC, 
    p09 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p10 = lm(Profit ~ 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p11 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Cancelled, degree = i), smp2) %>% extractAIC, 
    p12 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Won, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p13 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i), smp2) %>% extractAIC, 
    p14 = lm(Profit ~ 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p15 = lm(Profit ~ 
             poly(Turnover, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p16 = lm(Profit ~ 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p17 = lm(Profit ~ 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p18 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i), smp2) %>% extractAIC, 
    p19 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p20 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p21 = lm(Profit ~ 
             poly(Bettor, degree = i) * 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC, 
    p22 = lm(Profit ~ 
             poly(Turnover, degree = i) * 
             poly(Won, degree = i) * 
             poly(Cancelled, degree = i) * 
             poly(Rebates, degree = i), smp2) %>% extractAIC
    ) %>% 
    ldply %>% 
    as_tibble %>% 
    dplyr::rename(df = V1, AIC = V2)

    ## save files, easier to read.
    write_rds(mprf, path = paste0('data/mprf', i, '.rds'))
  })


```

<br>

##### åŸå§‹æ¨¡å‹

<br>

```{r, results = 'asis', eval = FALSE, warning = FALSE}
## https://stackoverflow.com/a/24133767/3806250
num <- 2:5

mprt_list <- llply(num, function(i) {
  mprt = list(
    #p00 = lm(Profit ~ 
    #         poly(Date, degree = i, raw = TRUE) * 
    #         poly(Bettor, degree = i, raw = TRUE) * 
    #         poly(Turnover, degree = i, raw = TRUE) * 
    #         poly(Won, degree = i, raw = TRUE) * 
    #         poly(Cancelled, degree = i, raw = TRUE) * 
    #         poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p01 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p02 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p03 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p04 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p05 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p06 = lm(Profit ~ 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p07 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p08 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p09 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p10 = lm(Profit ~ 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p11 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p12 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p13 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p14 = lm(Profit ~ 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p15 = lm(Profit ~ 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p16 = lm(Profit ~ 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p17 = lm(Profit ~ 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p18 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p19 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p20 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p21 = lm(Profit ~ 
             poly(Bettor, degree = i, raw = TRUE) * 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC, 
    p22 = lm(Profit ~ 
             poly(Turnover, degree = i, raw = TRUE) * 
             poly(Won, degree = i, raw = TRUE) * 
             poly(Cancelled, degree = i, raw = TRUE) * 
             poly(Rebates, degree = i, raw = TRUE), smp2) %>% extractAIC
    ) %>% 
    ldply %>% 
    as_tibble %>% 
    dplyr::rename(df = V1, AIC = V2)

    ## save files, easier to read.
    write_rds(mprt, path = paste0('data/mprt', i, '.rds'))
  })


```


#### å¤šé¡¹å¼ç¨‹åº¦æœ€ä¼˜åŒ–

ä»¥ä¸‹æ–‡ç« èŠåŠå¤šé¡¹å¼çº¿å‹æ¨¡å‹ç¨‹åº¦æœ€ä¼˜åŒ–ã€‚

```
To get a third order polynomial in x (x^3), you can do

lm(y ~ x + I(x^2) + I(x^3))
or

lm(y ~ poly(x, 3, raw=TRUE))
You could fit a 10th order polynomial and get a near-perfect fit, but should you?

EDIT: poly(x, 3) is probably a better choice (see @hadley below).
```
*å‡ºå¤„ï¼š[Fitting polynomial model to data in R](https://stackoverflow.com/a/3822706/3806250)*

```
But what I want to say is that a polynomial of more than 3-5 degree is never useful! The critical reason is the Runge's phenomenon. In terms of statistical terminology: a high-order polynomial always badly overfits data!. Don't naively think that because orthogonal polynomials are numerically more stable than raw polynomials, Runge's effect can be eliminated. No, a polynomial of degree k forms a vector space, so whatever basis you use for representation, they have the same span!
```
*å‡ºå¤„ï¼š[High (or very high) order polynomial regression in R (or alternatives?)](https://stackoverflow.com/a/39803843/3806250)*

```
Deciding on a degree
In performing a polynomial regression we must decide on the degree of the polynomial to use. One way to do this is by using hypothesis tests. We now fit models ranging from linear to a degree-5 polynomial and seek to determine the simplest model which is sufficient to explain the relationship between wage and age.

We can do this using the anova() function, which performs an analysis of variance (ANOVA, using an F-test) in order to test the null hypothesis that a model  M1  is sufficient to explain the data against the alternative hypothesis that a more complex model  M2  is required. In order to use the anova() function,  M1  and  M2  must be nested models: the predictors in  M1  must be a subset of the predictors in  M2 . In this case, we fit five different models and sequentially compare the simpler model to the more complex model:

fit_1 = lm(wage~age, data = Wage)
fit_2 = lm(wage~poly(age,2), data = Wage)
fit_3 = lm(wage~poly(age,3), data = Wage)
fit_4 = lm(wage~poly(age,4), data = Wage)
fit_5 = lm(wage~poly(age,5), data = Wage)
print(anova(fit_1,fit_2,fit_3,fit_4,fit_5))
```
*[7.8.1 Polynomial Regression and Step Functions7.8.1 Polynomial Regression and Step Functions](http://www.science.smith.edu/~jcrouser/SDS293/labs/lab12-r.html#Deciding-on-a-degree)*


```{r, results = 'asis', eval = FALSE, warning = FALSE}
# lm1 <- lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2)

# m.aic.backward1 <- step(lm1, direction = 'backward', trace = 1)
# m.aic.backward2 <- step(lm1)

md <- list(
  m00 = lm(Profit ~ poly(Date, 4) * poly(Type, 4) * poly(Bettor, 4) * poly(Turnover, 4) * poly(Won, 4) * poly(Cancelled, 4) * poly(Rebates, 4), smp2) %>% extractAIC, 
  m01 = lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m02 = lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled, smp2) %>% extractAIC, 
  m03 = lm(Profit ~ Type * Bettor * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m04 = lm(Profit ~ Type * Bettor * Turnover * Cancelled * Rebates, smp2) %>% extractAIC, 
  m05 = lm(Profit ~ Type * Bettor * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m06 = lm(Profit ~ Type * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m07 = lm(Profit ~ Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m08 = lm(Profit ~ Type * Bettor * Turnover * Won, smp2) %>% extractAIC, 
  m09 = lm(Profit ~ Type * Bettor * Turnover * Rebates, smp2) %>% extractAIC, 
  m10 = lm(Profit ~ Type * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m11 = lm(Profit ~ Type * Bettor * Turnover * Cancelled, smp2) %>% extractAIC, 
  m12 = lm(Profit ~ Type * Bettor * Won * Rebates, smp2) %>% extractAIC, 
  m13 = lm(Profit ~ Type * Bettor * Won * Cancelled, smp2) %>% extractAIC, 
  m14 = lm(Profit ~ Type * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m15 = lm(Profit ~ Type * Turnover * Cancelled * Rebates, smp2) %>% extractAIC, 
  m16 = lm(Profit ~ Type * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m17 = lm(Profit ~ Type * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m18 = lm(Profit ~ Bettor * Turnover * Won * Cancelled, smp2) %>% extractAIC, 
  m19 = lm(Profit ~ Bettor * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m20 = lm(Profit ~ Bettor * Turnover * Cancelled * Rebates, smp2) %>% extractAIC, 
  m21 = lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m22 = lm(Profit ~ Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC) %>% 
  ldply %>% 
  as_tibble %>% 
  dplyr::rename(df = V1, AIC = V2) %>% 

## save files, easier to read.
microbenchmark(
   save(md, file = 'data/md.rda'), 
   write_rds(md, path = 'data/md.rds'), 
   saveRDS(md, file = 'data/md.rds'))
#Unit: microseconds
#                                expr     min       lq     mean   median      uq     max neval
#      save(md, file = "data/md.rda") 114.666 130.9080 135.2061 134.3990 137.111 174.759   100
# write_rds(md, path = "data/md.rds") 111.098 120.6370 126.8601 125.1935 129.534 178.582   100
#   saveRDS(md, file = "data/md.rds") 143.649 160.3135 178.6935 183.2730 186.673 358.803   100
```

<br>
<br>

### åˆ†å±‚å¤šé¡¹å¼çº¿å‹æ¨¡å‹

![<span style='color:Orange'>*å›¾åƒ3.2.2aï¼šåˆ†å±‚å¤šé¡¹å¼çº¿å‹æ¨¡å‹*</span>* [High (or very high) order polynomial regression in R (or alternatives?)](https://stackoverflow.com/a/39803843/3806250)](figure/polynomials and orthogonal polymials.png)

![<span style='color:Orange'>*å›¾åƒ3.2.2bï¼šåˆ†å±‚å¤šé¡¹å¼çº¿å‹æ¨¡å‹*</span>* [High (or very high) order polynomial regression in R (or alternatives?)](https://stackoverflow.com/a/39803843/3806250)](figure/polynomials and orthogonal polymials 2.png)

![<span style='color:Orange'>*å›¾åƒ3.2.2cï¼šåˆ†å±‚å¤šé¡¹å¼çº¿å‹æ¨¡å‹*</span>* [High (or very high) order polynomial regression in R (or alternatives?)](https://stackoverflow.com/a/39803843/3806250)](figure/polynomials and orthogonal polymials 3.png)

```{r, results = 'asis', eval = FALSE, warning = FALSE}
## https://stackoverflow.com/a/24133767/3806250
# lm1 <- lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2)

# m.aic.backward1 <- step(lm1, direction = 'backward', trace = 1)
# m.aic.backward2 <- step(lm1)

mp <- list(
  p00 = lm(Profit ~ poly(Date, degree = 2, raw = TRUE) + * Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  p01 = lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m02 = lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled, smp2) %>% extractAIC, 
  m03 = lm(Profit ~ Type * Bettor * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m04 = lm(Profit ~ Type * Bettor * Turnover * Cancelled * Rebates, smp2) %>% extractAIC, 
  m05 = lm(Profit ~ Type * Bettor * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m06 = lm(Profit ~ Type * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m07 = lm(Profit ~ Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m08 = lm(Profit ~ Type * Bettor * Turnover * Won, smp2) %>% extractAIC, 
  m09 = lm(Profit ~ Type * Bettor * Turnover * Rebates, smp2) %>% extractAIC, 
  m10 = lm(Profit ~ Type * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m11 = lm(Profit ~ Type * Bettor * Turnover * Cancelled, smp2) %>% extractAIC, 
  m12 = lm(Profit ~ Type * Bettor * Won * Rebates, smp2) %>% extractAIC, 
  m13 = lm(Profit ~ Type * Bettor * Won * Cancelled, smp2) %>% extractAIC, 
  m14 = lm(Profit ~ Type * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m15 = lm(Profit ~ Type * Turnover * Cancelled * Rebates, smp2) %>% extractAIC, 
  m16 = lm(Profit ~ Type * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m17 = lm(Profit ~ Type * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m18 = lm(Profit ~ Bettor * Turnover * Won * Cancelled, smp2) %>% extractAIC, 
  m19 = lm(Profit ~ Bettor * Turnover * Won * Rebates, smp2) %>% extractAIC, 
  m20 = lm(Profit ~ Bettor * Turnover * Cancelled * Rebates, smp2) %>% extractAIC, 
  m21 = lm(Profit ~ Type * Bettor * Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC, 
  m22 = lm(Profit ~ Turnover * Won * Cancelled * Rebates, smp2) %>% extractAIC) %>% 
  ldply %>% 
  as_tibble %>% 
  dplyr::rename(df = V1, AIC = V2) %>% 

## save files, easier to read.
microbenchmark(
   save(md, file = 'data/md.rda'), 
   write_rds(md, path = 'data/md.rds'), 
   saveRDS(md, file = 'data/md.rds'))
#Unit: microseconds
#                                expr     min       lq     mean   median      uq     max neval
#      save(md, file = "data/md.rda") 114.666 130.9080 135.2061 134.3990 137.111 174.759   100
# write_rds(md, path = "data/md.rds") 111.098 120.6370 126.8601 125.1935 129.534 178.582   100
#   saveRDS(md, file = "data/md.rds") 143.649 160.3135 178.6935 183.2730 186.673 358.803   100
```


![<span style='color:Orange'>*å›¾åƒ3.2.3aï¼šæ‹Ÿåˆç”±`leaps :: regsubsets`é€‰æ‹©çš„å¤šé¡¹å¼å›å½’æ¨¡å‹*</span>* [å…³äºrï¼šæ‹Ÿåˆç”±`leaps :: regsubsets`é€‰æ‹©çš„å¤šé¡¹å¼å›å½’æ¨¡å‹](https://www.codenong.com/51223897)](figure/æ‹Ÿåˆç”±leaps regsubsetsé€‰æ‹©çš„å¤šé¡¹å¼å›å½’æ¨¡å‹1.png)

![<span style='color:Orange'>*å›¾åƒ3.2.3bï¼šæ‹Ÿåˆç”±`leaps :: regsubsets`é€‰æ‹©çš„å¤šé¡¹å¼å›å½’æ¨¡å‹*</span>* [å…³äºrï¼šæ‹Ÿåˆç”±`leaps :: regsubsets`é€‰æ‹©çš„å¤šé¡¹å¼å›å½’æ¨¡å‹](https://www.codenong.com/51223897)](figure/æ‹Ÿåˆç”±leaps regsubsetsé€‰æ‹©çš„å¤šé¡¹å¼å›å½’æ¨¡å‹2.png)


<br>
<br>

## å¤šå…ƒå†…åµŒæ¨¡å‹

<br>

ä»¥ä¸‹æ–‡çŒ®åŒ…å«`å¤šå…ƒç›¸äº’å¼æ¨¡å‹`ã€`å¤šé¡¹å¼æ¨¡å‹`ã€`å¤šå…ƒå†…åµŒæ¨¡å‹`ã€‚

- [å¦‚ä½• Estimate linear models](https://d.cosx.org/d/419820-estimate-linear-models)å’Œ[`lm()`åŒ…ä¸­formula è¡¨è¾¾æ–¹æ³•çš„é—®é¢˜](https://d.cosx.org/d/157623-157623)^[å¤šç›¸äº’ä½œç”¨å’Œå†…åµŒçº¿æ€§æ¨¡å‹]
- [R-Blog : Using R and lme/lmer to fit different two- and three-level longitudinal models](https://www.r-bloggers.com/2015/04/using-r-and-lmelmer-to-fit-different-two-and-three-level-longitudinal-models/)^[åŸç¨¿:[Using R and lme/lmer to fit different two- and three-level longitudinal models](https://rpsychologist.com/r-guide-longitudinal-lme-lmer)å¤šå…ƒå†…åµŒçº¿å‹æ¨¡å‹]
- [lmer poly() function on interactions](https://stackoverflow.com/questions/58943913/lmer-poly-function-on-interactions)^[å†…åµŒå¤šé¡¹å¼çº¿å‹æ¨¡å‹(Polynomial Regression)]

```{r}

```

<br>
<br>

## æ··åˆæ¨¡å‹

<br>

ä»¥ä¸‹æ–‡çŒ®åŒ…å«`å¤šå…ƒç›¸äº’å¼æ¨¡å‹`ã€`å¤šé¡¹å¼æ¨¡å‹`ã€`å¤šå…ƒå†…åµŒæ¨¡å‹`ã€‚

- [å¦‚ä½• Estimate linear models](https://d.cosx.org/d/419820-estimate-linear-models)å’Œ[`lm()`åŒ…ä¸­formula è¡¨è¾¾æ–¹æ³•çš„é—®é¢˜](https://d.cosx.org/d/157623-157623)^[å¤šç›¸äº’ä½œç”¨å’Œå†…åµŒçº¿æ€§æ¨¡å‹]
- [R-Blog : Using R and lme/lmer to fit different two- and three-level longitudinal models](https://www.r-bloggers.com/2015/04/using-r-and-lmelmer-to-fit-different-two-and-three-level-longitudinal-models/)^[åŸç¨¿:[Using R and lme/lmer to fit different two- and three-level longitudinal models](https://rpsychologist.com/r-guide-longitudinal-lme-lmer)å¤šå…ƒå†…åµŒçº¿å‹æ¨¡å‹]
- [lmer poly() function on interactions](https://stackoverflow.com/questions/58943913/lmer-poly-function-on-interactions)^[å†…åµŒå¤šé¡¹å¼çº¿å‹æ¨¡å‹(Polynomial Regression)]

```{r}
## https://stackoverflow.com/a/24133767/3806250


```

<br>
<br>

## æ—¶é—´åºåˆ—æ¨¡å‹

<br>

ä¸Šä¸ªç« èŠ‚è°ˆåŠæœ€ä¼˜ä¸‰ä¸ªæ¨¡å‹ï¼Œè¿™å„¿å’±ä»¬å¾—å…ˆç§ç§*å›¾è¡¨3.1ï¼šæ¯æ—¥è§‚æµ‹å€¼*æ¯æ—¥è§‚æµ‹å€¼å†å†³å®šæ•°æ®å¤šå¯¡ã€‚

```{r}

```


<br>
<br>

### 30å¤©æ•°æ®

<br>

```{r}
##https://stackoverflow.com/questions/24133356/how-to-replicate-a-ddply-behavior-that-uses-a-custom-function-with-dplyr/24133767#24133767

```

<br>
<br>

### 40å¤©æ•°æ®

<br>

....

<br>
<br>

# ç»˜å›¾

<br>

## æŠ•æ³¨äººæ•°

<br>

## æŠ•æ³¨é‡‘é¢

<br>

## ä¸­å¥–é‡‘é¢

<br>

## æ’¤å•é‡‘é¢

<br>

## è¿”ç‚¹é‡‘é¢

<br>

## ç›ˆåˆ©

<br>

## ç›ˆç‡

<br>
<br>

# ç»“è®º

<br>

## æ€»ç»“

${\color{Black} \circledR} {\color{DarkGreen} \gamma} {\color{Red} \sigma} \; {\color{Blue} \xi} {\color{Red} \eta} {\color{Blue} g}$^[[Latex Equation](https://www.codecogs.com/latex/eqneditor.php)] ğŸ^[[Emoji list](https://gist.github.com/rxaviers/7360908)]

<br>

## é™„å½•

```{r, warning = FALSE, results = 'asis'}
suppressMessages(require('dplyr', quietly = TRUE))
suppressMessages(require('magrittr', quietly = TRUE))
suppressMessages(require('formattable', quietly = TRUE))
suppressMessages(require('knitr', quietly = TRUE))
suppressMessages(require('kableExtra', quietly = TRUE))

sys1 <- devtools::session_info()$platform %>% 
  unlist %>% data.frame(Category = names(.), session_info = .)
rownames(sys1) <- NULL

sys2 <- data.frame(Sys.info()) %>% mutate(Category = rownames(.)) %>% .[2:1]
names(sys2)[2] <- c('Sys.info')
rownames(sys2) <- NULL

if (nrow(sys1) == 9 & nrow(sys2) == 8) {
  sys2 %<>% rbind(., data.frame(
  Category = 'Current time', 
  Sys.info = paste(as.character(lubridate::now('Asia/Tokyo')), 'JSTğŸ—¾')))
} else {
  sys1 %<>% rbind(., data.frame(
  Category = 'Current time', 
  session_info = paste(as.character(lubridate::now('Asia/Tokyo')), 'JSTğŸ—¾')))
}

cbind(sys1, sys2) %>% 
  kbl(caption = 'Additional session information:') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  row_spec(9, bold = T, color = 'white', background = '#D7261E')
```

## å‚è€ƒæ–‡çŒ®

1) [Free themes for Bootstrap](https://bootswatch.com/3/)

2) [R packages for optimal stratified sampling: a review and compared evaluation](https://www.researchgate.net/publication/327791484_R_packages_for_optimal_stratified_sampling_a_review_and_compared_evaluation/comments)

3) [Use of models in SamplingStrata](https://cran.r-project.org/web/packages/SamplingStrata/vignettes/models.html)

4) [Example of Using a Banner Image with RMarkdown](https://rpubs.com/thaufas/555157)

5) [IN R MARKDOWN, How Can I add a background image (HTML output)?](https://stackoverflow.com/questions/60498668/in-r-markdown-how-can-i-add-a-background-image-html-output)

6) [CSS Background Image Size Tutorial â€“ How to Code a Full Page Background Image](https://www.freecodecamp.org/news/css-full-page-background-image-tutorial)

---

<span style='color:RoyalBlue'>**Powered by - CopyrightÂ® Intellectual Property Rights of <img src='figure/scibrokes_trading.jpg' width='24'> [SÏ‚Î¹Î²rÎ¿ÎºÎµrs TrÎ±dÎ¹Î·gÂ®ï¸](http://www.scibrokes.com)çµŒå–¶ä¼æ¥­**</span>

